<!DOCTYPE html>

<html lang="es">
<head><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&amp;display=swap" rel="stylesheet"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Creador de Descripciones Largas</title>
<style>
    body {
      font-family: 'Roboto', 'Roboto', sans-serif;
  line-height: 1.6;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
      font-size: 15px;
    }
    .header {
      background-color: #0056b3;
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
    }
    .container {
      max-width: 900px;
      margin: 30px auto;
      padding: 0 20px;
    }
    .attribute-group {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 20px;
      border: 1px solid #ddd;
    }
    .form-unitario-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .full-width {
      grid-column: 1 / -1;
    }
    label {
      font-weight: bold;
      font-size: 14px;
      margin-bottom: 4px;
      display: block;
      color: #333;
    }
    input::placeholder {
      font-style: italic;
      color: #999;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 4px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-family: inherit;
      font-size: 14px;
    }
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    button {
      background-color: #555;
      color: white;
      border: none;
      padding: 8px 14px;
      font-size: 13px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      text-transform: capitalize;
    }
    button:hover {
      background-color: #333;
    }
    .categoria-export {
  background-color: white;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  padding: 20px;
  margin-bottom: 30px;
  font-size: 15px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: flex-start;
}
    .categoria-export ul {
  text-align: left;
      background: #f5f5f5;
      padding: 10px;
      border-radius: 5px;
      list-style: none;
      padding-left: 20px;
    }
    .categoria-export ul li {
      position: relative;
      padding-left: 20px;
      margin-bottom: 8px;
    }
    .categoria-export p {
  text-align: left;
}

.categoria-export ul li::before {
      content: "\2022";
      position: absolute;
      left: 0;
      color: #555;
    }
    .categoria-export .image-columns {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    .categoria-export .image-columns img {
    width: calc(50% - 5px);
    height: auto;
    border-radius: 8px;
    object-fit: cover;
    aspect-ratio: 1 / 1;
  }
    @media (max-width: 600px) {
  .categoria-export .image-columns {
    flex-direction: row;
    flex-wrap: wrap;
  }
  .categoria-export .image-columns img {
    width: 100%;
  }
}
  .categoria-export .image-columns img {
    width: calc(50% - 5px);
  }
}
  .categoria-export .image-columns img {
    flex: 1 1 100%;
    width: 100%;
  }
}
    }
  
/* Botones modernos */
button {
  background-color: #2C666E;
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}
button:hover {
  background-color: #1e474b;
}

/* Header m√°s elegante */
.header {
  font-family: 'Roboto', sans-serif;
  letter-spacing: 1px;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

/* Espaciado entre secciones */
.attribute-group {
  margin-bottom: 30px;
}

/* Tipograf√≠a m√°s sobria */
body {
  font-size: 14px;
  font-weight: 400;
}
::placeholder {
  font-style: italic;
  color: #aaa;
}

/* Redondear im√°genes cuadradas */
.categoria-export img {
  border-radius: 10px;
}

/* Tama√±o iconos diferenciadores */
.categoria-export .icono-diferenciador {
  width: 64px !important;
  height: 64px !important;
  object-fit: contain;
}

/* Responsive buttons */
@media (max-width: 480px) {
  .button-group {
    flex-direction: column;
  }
}

.attribute-group p, .attribute-group ul, .attribute-group li { font-size: 13px; }</style>
<style>
  body {
    font-family: 'Roboto', sans-serif;
    background-color: #f4f6f8;
    color: #333;
  }
  .header {
    background-color: #003366;
    color: #fff;
    font-size: 26px;
    font-weight: 600;
    padding: 20px;
    border-bottom: 5px solid #0059b3;
  }
  button, .btn {
    background-color: #0059b3;
    color: #fff;
    border: none;
    padding: 10px 20px;
    margin: 5px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.3s;
  }
  button:hover, .btn:hover {
    background-color: #0073e6;
  }
  input, select, textarea {
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 8px;
    font-size: 14px;
  }
  .categoria-export {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    padding: 20px;
    margin-bottom: 30px;
  }
  .categoria-export h3 {
    color: #003366;
  }
  .categoria-export ul {
    background: #eef2f7;
    padding: 10px;
    border-radius: 6px;
    list-style: none;
    padding-left: 20px;
  }
  .categoria-export ul li {
    margin-bottom: 8px;
  }
</style>
<style>
  #btnAgregar:hover {
    background-color: #3fbf7f !important;
  }
</style>
<style>
  .button-group button {
    font-size: 13px !important;
    padding: 6px 12px !important;
  }
  #btnAgregar:hover {
    background-color: #3fbf7f !important;
  }
</style>
<style>
  #btnAgregar {
    font-size: 13px !important;
    padding: 6px 12px !important;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #btnAgregar:hover {
    background-color: #3fbf7f !important;
  }
</style>
</head>
<body>
<div class="header">Creador de Descripciones Largas</div>
<div class="container">
<div class="attribute-group">
<h3 style="font-weight:bold;">Instrucciones</h3><hr style="border: 0; border-top: 1px solid #ccc; margin-top: 5px; margin-bottom: 15px;"/>
<p>üìÑ Descargar Plantilla: Puedes descargar una plantilla de ejemplo para completar correctamente.</p>
<p>üìÖ Procesar Excel: Sube un archivo Excel con los productos para generar autom√°ticamente las descripciones. Aseg√∫rate de que contenga los siguientes campos: <em>SKU, Nombre, Tipo, Marca, Beneficios, Informaci√≥n adicional, URL Imagen y diferenciadores si es que aplica.</em></p>
<h3 style="font-weight:bold; margin-top: 20px;">Directrices</h3>
<hr style="border: 0; border-top: 1px solid #ccc; margin-top: 5px; margin-bottom: 15px;"/>
<p><strong>üìù Beneficios:</strong> Los valores deben estar separados por punto y coma (<code>;</code>), ya que se convierte en formato Lista.<br/>
<em>Ej: 12 horas de hidrataci√≥n; Disponible en 14 tonos flexibles; Acabado brillante y luminoso.</em></p>
<p><strong>üì∑ Carga de im√°genes:</strong> En los campos de im√°genes debes ingresar el nombre la imagen que vas a cargar, esta debe estar previamente cargada en FileZilla. <em>(Ej: Dif_129897999.webp)</em></p>
<ul style="padding-left: 25px; margin-top: 0;">
<li>üñºÔ∏è Imagen diferenciadora 1: Imagen en formato horizontal o extendida (alargada)</li>
<li>üñºÔ∏è Imagen diferenciadora 1 2: Imagen en formato cuadrado</li>
<li>üñºÔ∏è Imagen diferenciadora 1 3: Imagen en formato cuadrado</li>
</ul>
</div>
<label for="excelInput">üìÅ Selecciona tu archivo Excel:</label>
<input accept=".xlsx, .xls" id="excelInput" type="file"/>
<div class="button-group">
<button id="btnProcesar">üì• Procesar Excel</button>
<button id="btnPlantilla">üìÑ Descargar Plantilla</button>
<button id="btnExportar">‚¨áÔ∏è Exportar HTML a Excel</button>
<button id="btnLimpiar">üßπ Limpiar</button> <button id="btnAgregar" style="background-color:#2C666E;">üëÅÔ∏è Ver Descripciones Generadas</button></div>
</div>
<div id="descripcionFinal" style="max-width:900px;margin:0 auto;padding:10px;"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js">
function completarRutaImagen(valor) {
  if (!valor) return "";
  if (valor.startsWith("http")) return valor;
  return "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/" + valor + "?$staticlink$";
}


function mostrarPreview(input, previewId) {
  const valor = completarRutaImagen(input.value.trim());
  const contenedor = document.getElementById(previewId);
  contenedor.innerHTML = valor ? `<img src="${valor}" style='margin-top:5px;max-width:100px;height:auto;border:1px solid #ccc;border-radius:4px;'>` : "";
}

</script>
<script>
    const coloresPermitidos = { azul: "#007bff", rosa: "#e91e63", negro: "#000000" };
    let fichasGeneradas = [];

    function procesarExcel() {
      const input = document.getElementById("excelInput");
      const file = input.files[0];
      if (!file) return alert("Por favor selecciona un archivo Excel.");

      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const rows = XLSX.utils.sheet_to_json(sheet);
            // Marcar checkboxes seg√∫n diferenciales del primer producto
    const [
  sku, nombre, tipo, marca, beneficios, infoAdicional,
url1, url2, url3, color, dif1, dif2, dif3, dif4
] = jsonData[1] || [];


    const checkboxContainer = document.getElementById("checkboxDiferenciadores");
    const checkboxes = checkboxContainer.querySelectorAll("input[type='checkbox']");
    [ dif1, dif2, dif3, dif4 ].forEach(valor => {
      if (!valor) return;
      checkboxes.forEach(cb => {
        if (cb.value.trim().toLowerCase() === valor.trim().toLowerCase()) {
          cb.checked = true;
        }
      });
    });

        if (!rows.length) return alert("El archivo Excel est√° vac√≠o o mal estructurado.");

        rows.forEach(item => {
          const colorNombre = (item["Color del T√≠tulo"] || "").toLowerCase();
          const color = coloresPermitidos[colorNombre] || "#000000";

      const diferenciadores = Array.from(document.querySelectorAll("#checkboxDiferenciadores input:checked")).map(c => c.value);
      const iconosMap = {
        "Cruelty Free": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-crueltyfree.png?$staticlink$",
        "Libre de Pesticidas": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-libre-pesticidas.png?$staticlink$",
        "No Probado en Animales": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-probado-animales.png?$staticlink$",
        "No Toxico": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-toxico.png?$staticlink$",
        "Probado Lab": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-probado-lab.png?$staticlink$",
        "Sin Aceite": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-aceite.png?$staticlink$",
        "Sin Parabenos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-parabenos.png?$staticlink$",
        "Sin Sulfatos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-sulfatos.png?$staticlink$",
        "Vegano": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-vegano.png?$staticlink$"
      };
      const iconosHTML = diferenciadores.length > 0
        ? `<div style='display:flex;gap:10px;flex-wrap:wrap;'>${diferenciadores.map(d => `<img src='${iconosMap[d]}' alt='${d}' style='width:80px;height:80px;max-width:100%;height:auto;object-fit:contain;'>`).join("")}</div>`
        : "";

          const beneficiosHTML = item["Beneficios"]
  ? `<ul>${item["Beneficios"].split(";").map(b => {
      const [antes, despues] = b.split(":");
      return despues
        ? `<li><strong>${antes.trim()}:</strong> ${despues.trim()}</li>`
        : `<li>${b.trim()}</li>`;
    }).join("")}</ul>`
  : "";
          const imagenesHTML = `
            ${item["URL Imagen"] ? `<div class='image-main'><img src='${item["URL Imagen"]}'></div>` : ""}
            <div class='image-columns'>
              ${item["URL Imagen 2"] ? `<img src='${item["URL Imagen 2"]}'>` : ""}
              ${item["URL Imagen 3"] ? `<img src='${item["URL Imagen 3"]}'>` : ""}
            </div>`;
          const ficha = `
            <div class='categoria-export'>
              <h3 style='color:${color}'>${item["Nombre"] || ""} ${item["Marca"] || ""}</h3>
              ${beneficiosHTML}
          ${iconosHTML}
              <p>${item["Informaci√≥n adicional"] || ""}</p>
              ${imagenesHTML}
            </div>
          `;
          document.getElementById("descripcionFinal").innerHTML += ficha;
          fichasGeneradas.push({ sku: item["SKU"], html: ficha });
        });
        alert("‚úÖ Excel procesado correctamente");
      };
      reader.readAsArrayBuffer(file);
    }

    function descargarPlantilla() {
  const link = document.createElement('a');
  link.href = "plantilla_descripciones.xlsx"; // debe coincidir con el nombre del archivo subido
  link.download = "plantilla_descripciones.xlsx";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  alert("üìÑ Plantilla descargada exitosamente");
}

    
function descargarExcel() {
  if (!fichasGeneradas.length) {
    alert("No hay fichas generadas para exportar.");
    return;
  }

  const data = fichasGeneradas.map(f => {
    const parser = new DOMParser();
    const doc = parser.parseFromString(f.html, 'text/html');
    const container = doc.querySelector('.categoria-export');

    container.setAttribute("style", "background-color:white;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.08);padding:20px;margin-bottom:30px;font-size:15px;display:flex;flex-direction:column;gap:10px;align-items:flex-start;");

    const ul = container.querySelector("ul");
    if (ul) ul.setAttribute("style", "text-align:left;background:#f5f5f5;padding:10px;border-radius:5px;list-style:none;padding-left:20px;margin:0;");

    const lis = container.querySelectorAll("ul li");
    lis.forEach(li => {
      li.setAttribute("style", "position:relative;padding-left:20px;margin-bottom:8px;");
      const texto = li.innerHTML;
      if (texto.includes(":")) {
        const [antes, despues] = texto.split(":");
        li.innerHTML = `<span style='position:absolute;left:0;color:#555;'>&bull;</span><strong>${antes.trim()}:</strong> ${despues.trim()}`;
      } else {
        li.innerHTML = `<span style='position:absolute;left:0;color:#555;'>&bull;</span>${texto.trim()}`;
      }
    });

    const p = container.querySelector("p");
    if (p) p.setAttribute("style", "text-align:left;margin:0;");

    const imgMain = container.querySelector(".image-main img");
    if (imgMain) {
      imgMain.setAttribute("style", "width:100%;max-width:600px;height:auto;display:block;margin:0 auto;");
    }

    const imageCols = container.querySelector(".image-columns");
    if (imageCols) {
      imageCols.removeAttribute("class");
      imageCols.setAttribute("style", "display:flex;flex-wrap:wrap;gap:10px;margin-top:15px;");
      const imgs = imageCols.querySelectorAll("img");
      imgs.forEach(img => {
        img.setAttribute("style", "width:calc(50% - 5px);max-width:100%;height:auto;border-radius:8px;object-fit:cover;aspect-ratio:1/1;");
      });
    }

    let htmlExportado = container.outerHTML.trim();
    htmlExportado = htmlExportado.replace(/"(.*?)"/g, "'$1'");

    return {
      SKU: f.sku || "",
      "Descripci√≥n Larga/Emocional": htmlExportado
    };
  });

  const ws = XLSX.utils.json_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Fichas");
  const hoy = new Date().toISOString().split('T')[0];
  XLSX.writeFile(wb, `Descripciones_Generadas_${hoy}.xlsx`);
  alert("‚¨áÔ∏è Archivo Excel exportado exitosamente");
}


function limpiarTodo() {
  document.getElementById("excelInput").value = "";
  document.getElementById("descripcionFinal").innerHTML = "";
  fichasGeneradas = [];
  datosProcesados = [];
  actualizarContador();
  alert("üßπ Formulario limpiado");
}

    

    document.getElementById("btnProcesar").addEventListener("click", procesarExcel);
    document.getElementById("btnPlantilla").addEventListener("click", descargarPlantilla);
    document.getElementById("btnExportar").addEventListener("click", descargarExcel);
    document.getElementById("btnLimpiar").addEventListener("click", limpiarTodo);
  
function completarRutaImagen(valor) {
  if (!valor) return "";
  if (valor.startsWith("http")) return valor;
  return "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/" + valor + "?$staticlink$";
}


function mostrarPreview(input, previewId) {
  const valor = completarRutaImagen(input.value.trim());
  const contenedor = document.getElementById(previewId);
  contenedor.innerHTML = valor ? `<img src="${valor}" style='margin-top:5px;max-width:100px;height:auto;border:1px solid #ccc;border-radius:4px;'>` : "";
}

</script>
<script>
    document.getElementById("btnPlantilla").addEventListener("click", function () {
    const url = "https://catalogo2025.github.io/creador-descripciones-largas/Plantilla_Actualizada_Logo.xlsx";
    const a = document.createElement("a");
    a.href = url;
    a.download = "Plantilla_Actualizada_Logo.xlsx";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });

function completarRutaImagen(valor) {
  if (!valor) return "";
  if (valor.startsWith("http")) return valor;
  return "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/" + valor + "?$staticlink$";
}


function mostrarPreview(input, previewId) {
  const valor = completarRutaImagen(input.value.trim());
  const contenedor = document.getElementById(previewId);
  contenedor.innerHTML = valor ? `<img src="${valor}" style='margin-top:5px;max-width:100px;height:auto;border:1px solid #ccc;border-radius:4px;'>` : "";
}

</script>
<script>
  // Aqu√≠ van: colorMap, rutasIconos, datosProcesados, procesarExcel(), mostrarTablaDesdeExcel()

  const colorMap = {
    negro: "#000000",
    azul: "#007bff",
    rosa: "#e91e63"
  };

  const rutasIconos = {
    "Cruelty Free": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-crueltyfree.png?$staticlink$",
    "Libre de Pesticidas": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-libre-pesticidas.png",
    "No Probado en Animales": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-probado-animales.png",
    "No Toxico": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-toxico.png",
    "Probado Lab": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-probado-lab.png",
    "Sin Aceite": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-aceite.png",
    "Sin Parabenos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-parabenos.png",
    "Sin Sulfatos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-sulfatos.png",
    "Vegano": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-vegano.png"
  };

  let datosProcesados = [];

  function procesarExcel() {
    const fileInput = document.getElementById("excelInput");
    const file = fileInput.files[0];

    if (!file) {
      alert("Por favor selecciona un archivo Excel.");
      return;
    }

    const reader = new FileReader();
    reader.onload = function (e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: "array" });
      const firstSheet = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[firstSheet];
      const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
      datosProcesados = jsonData;
      alert("‚úÖ Archivo procesado correctamente. Ahora puedes presionar 'Ver Tabla'.");
    };
    reader.readAsArrayBuffer(file);
  }

  function mostrarTablaDesdeExcel() {
    const contenedor = document.getElementById("descripcionFinal");
    contenedor.innerHTML = "";

    datosProcesados.slice(1).forEach((fila) => {
      const [sku, nombre, tipo, marca, beneficios, infoAdicional, logo, url1, url2, url3, color, dif1, dif2, dif3, dif4] = fila;

// Arma la URL del logo correctamente, solo si no es externa
const rutaLogo = logo
  ? (logo.startsWith("http") ? logo : `https://www.paris.cl/images/Contenido%20Fichas/Logos/${logo}?$staticlink$`)
  : "";

// Inserta la etiqueta <img> solo si hay logo
const logoHTML = rutaLogo
  ? `<img src="${rutaLogo}" alt="Logo" style="max-height:100px;width:auto;display:block;margin-top:8px;margin-bottom:12px;">`
  : "";
const rutaImagen1 = completarRutaImagen(url1);
      const rutaImagen2 = completarRutaImagen(url2);
      const rutaImagen3 = completarRutaImagen(url3);


      
    const beneficiosItems = beneficios?.split(";").map(b => `<li>${b.trim()}</li>`).join("") || "";
    const beneficiosLista = beneficiosItems
      ? `<strong>Caracter√≠sticas:</strong><ul style="background:#f5f5f5;padding:10px;border-radius:5px;list-style:none;padding-left:20px;">${beneficiosItems}</ul>`
      : "";
    

      const iconos = [dif1, dif2, dif3, dif4].filter(Boolean).map(valor => {
        const src = rutasIconos[valor.trim()];
        return src ? `<img src="${src}" alt="${valor}" style="width:80px;height:80px;object-fit:contain;">` : '';
      }).join("");

      const html = `
          <div style='background:#eee;padding:5px 10px;border-radius:5px;font-size:13px;margin-bottom:5px;'>üì¶ SKU: ${sku}</div>
        <div class="categoria-export" style="background:white;padding:15px;border-radius:8px;margin-bottom:25px;font-size:15px;">
          <h3 style="color:${colorMap[color?.toLowerCase()] || '#000'}">${nombre || "Sin nombre"} ${marca ? `- ${marca}` : ""}</h3>\n          ${logoHTML}
          ${beneficiosLista}
          
           ${iconos ? `<div style="margin-top:10px;display:flex;flex-wrap:wrap;gap:10px;">${iconos}</div>` : ""}
          
          ${infoAdicional ? `<p>${infoAdicional}</p>` : ""}
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;">
            ${rutaImagen1 ? `<img src="${rutaImagen1}" style="max-width:100%;height:auto;">` : ''}
            ${rutaImagen2 ? `<img src="${rutaImagen2}" style="width:48%;height:auto;">` : ''}
            ${rutaImagen3 ? `<img src="${rutaImagen3}" style="width:48%;height:auto;">` : ''}
          </div>
        </div>
      `;
      contenedor.innerHTML += html;
    fichasGeneradas.push({ sku: sku || '', html: html });
    });
  }

  // Asocia eventos con los botones
  document.getElementById("btnProcesar").addEventListener("click", procesarExcel);
  document.getElementById("btnAgregar").addEventListener("click", mostrarTablaDesdeExcel);

function completarRutaImagen(valor) {
  if (!valor) return "";
  if (valor.startsWith("http")) return valor;
  return "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/" + valor + "?$staticlink$";
}


function mostrarPreview(input, previewId) {
  const valor = completarRutaImagen(input.value.trim());
  const contenedor = document.getElementById(previewId);
  contenedor.innerHTML = valor ? `<img src="${valor}" style='margin-top:5px;max-width:100px;height:auto;border:1px solid #ccc;border-radius:4px;'>` : "";
}

</script>
<script>
  function actualizarContador() {
    const contador = document.getElementById("contadorFichas");
    const num = document.querySelectorAll(".categoria-export").length;
    if (contador) contador.textContent = num;
  }
</script>
</body>
</html>
